<h1 align="center">无人值守图书馆系统架构评审文档</h1>

## 1. ATAM方法表述

### 1.1 概述

ATAM（Architecture Tradeoff Analysis Method）是SEI提出的一种软件架构评估方法。本文档旨在通过ATAM方法对无人值守图书馆系统（云端书舍，E-Librarian）的架构进行评估。ATAM的主要目的包括：

1. 提炼出软件质量属性需求的精确描述；
2. 提炼出架构设计决策的精确描述；
3. 评估这些架构设计决策，并判定其是否令人满意地实现了这些质量需求。

### 1.2 架构涉众

- 读者
- 老年读者
- 外语用户
- 管理员
- 开发人员
- 测试人员

### 1.3 评估步骤

ATAM的评估步骤包括：

1. ATAM描述；
2. 商业动机表述；
3. 软件架构表述；
4. 确定架构方式；
5. 生成效用树；
6. 分析架构方式；
7. 确定场景及其优先级；
8. 进一步分析架构方式；
9. 得出结论。

## 2. 商业动机的描述

### 2.1 业务目标

云端书舍旨在提供用户一个快速、直观、全天候的图书馆服务体验，通过自动化和数据分析提升图书馆运营效率，扩大服务范围，增强品牌形象，并确保可持续发展。

### 2.2 质量属性

根据业务目标，我们可以将质量属性划分为以下几类：

- 高优先级质量属性：性能、安全性、易用性、可用性
- 重要但优先级较低的属性：可维护性、可修改性、可移植性

## 3. 架构表述

### 3.1 架构样式

系统采用三层客户端-服务器（C/S）样式，包括表示层、业务逻辑层、数据层。此外，系统内部处理信息流程时，采用管道-过滤器样式。

### 3.2 参考模型

系统遵循ISO/OSI七层模型、数据库管理系统的参考模型、图书馆管理系统特定参考模型、系统安全参考模型和系统可用性参考模型。

### 3.3 组件视图

系统包括用户接口（自助服务终端、移动应用、Web门户）、业务逻辑组件（账户管理服务、图书检索服务、借阅管理服务等）和数据访问对象。

## 4. 质量属性效用树

### 4.1 性能

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC1 | 性能 | 并发用户支持 | 系统应支持至少1000个并发用户同时操作，确保响应时间在2秒内。 | (H, H) |
| SC2 | 性能 | 响应时间 | 系统应在2秒内响应用户登录、查询、借阅和归还等请求。 | (H, M) |
| SC3 | 性能 | 资源利用率 | 监控CPU、内存、网络等资源的使用情况，确保系统高效运行。 | (M, L) |

### 4.2 安全性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC4 | 安全性 | 数据保护 | 系统应能抵御至少1000个并发的恶意访问尝试而不崩溃，保证数据不被未授权访问。 | (H, H) |
| SC5 | 安全性 | 访问控制 | 系统应实施严格的访问控制策略，确保只有授权用户才能访问敏感数据。 | (H, M) |
| SC6 | 安全性 | 入侵检测 | 系统应具备入侵检测系统，及时发现并响应安全威胁。 | (M, H) |

### 4.3 可用性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC7 | 可用性 | 系统稳定性 | 系统应具备自我检测和自我修复的能力，确保99%的年平均正常运行时间。 | (H, M) |
| SC8 | 可用性 | 故障恢复 | 系统应能在关键组件故障后快速恢复服务，减少服务中断时间。 | (H, M) |
| SC9 | 可用性 | 数据备份 | 定期备份数据库和重要文件，确保数据的持久性和一致性。 | (M, H) |

### 4.4 易用性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC10 | 易用性 | 用户满意度 | 系统应有至少80%的用户满意度（基于任意100名用户调查）。 | (H, M) |
| SC11 | 易用性 | 学习曲线 | 系统应能保证95%的任意类型的用户能在5分钟内学会基本操作，而不需要额外的培训或指导。 | (H, L) |
| SC12 | 易用性 | 界面可访问性 | 为老年读者和外语用户提供大字号简化版本、语音搜索功能、多语言界面选项。 | (M, H) |

### 4.5 可维护性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC13 | 可维护性 | 维护成本 | 系统应设计成易于维护，以降低长期维护成本。 | (M, M) |
| SC14 | 可维护性 | 维护时间 | 系统维护应能在不影响正常服务的情况下进行，每次维护预计不超过2小时。 | (M, L) |

### 4.6 可修改性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC15 | 可修改性 | 规则变更支持 | 系统应支持至少5种不同的借阅规则变更，而无需修改核心代码。 | (M, H) |
| SC16 | 可修改性 | 功能升级 | 系统应支持在线升级，无需停机即可添加新功能或改进现有功能。 | (M, M) |

### 4.7 可移植性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC17 | 可移植性 | 跨平台支持 | 系统应能在不超过1周的时间内迁移到不同的操作系统。 | (L, H) |
| SC18 | 可移植性 | 数据库迁移 | 系统应能在不同的数据库系统之间迁移，迁移时间不超过2天。 | (L, M) |

### 4.8 可复用性

| 场景编号 | 质量属性 | 属性求精 | 场景描述 | 优先级 |
| --- | --- | --- | --- | --- |
| SC19 | 可复用性 | 功能复用 | 系统应能保证各主要功能（如登录、注册、查询记录等）在移植到其他类似系统时应能在其他项目中直接复用，无需或仅需少量修改。 | (L, H) |

## 5. 质量场景的架构分析

### 场景 SC1: 性能 - 并发用户支持
- **场景号**：SC1
- **属性**：性能
- **环境**：系统处于用户高峰时期
- **刺激**：用户请求访问
- **响应**：系统需在2秒内响应每个用户的请求

**采用战术**：
1. 负载均衡器分配请求到不同的服务器
2. 数据库索引优化以加速查询

**敏感点**：
1. 负载均衡器的性能和稳定性

**有风险决策**：
1. 自动扩展资源可能导致成本增加

**无风险决策**：
1. 使用缓存提高响应速度

**推理**：
- 负载均衡器是关键组件，其性能和稳定性直接影响系统的并发处理能力。
- 自动扩展资源虽然可以保证性能，但可能会增加运营成本。
- 使用缓存是一种成熟且低成本的方法，可以显著提高系统的响应能力。

### 场景 SC4: 安全性 - 数据保护
- **场景号**：SC4
- **属性**：安全性
- **环境**：面临恶意访问攻击
- **刺激**：检测到1000个并发的恶意访问尝试
- **响应**：系统必须成功抵御攻击，确保数据不被泄露

**采用战术**：
1. 切断外网连接
2. 强化入侵检测系统(IDS)

**敏感点**：
1. 数据加密的强度和对系统性能的影响

**有风险决策**：
1. 切断外网连接可能会在攻击结束后延迟恢复服务，影响用户访问图书馆资源。

**无风险决策**：
1. 定期进行安全审计和更新

**推理**：
- 切断外网连接可以有效阻止资源被进一步窃取，提高系统的安全性，但可能会影响正常用户的服务。
- IDS可以更快识别出非法的恶意访问，防止资源被窃取，但如果配置过于敏感，可能会产生大量误报，影响正常用户的访问体验。
- 定期的安全审计和更新是确保系统长期安全的有效方法，且不会引入额外的风险。

## 6. 对系统架构的再分析

### 6.1 风险决策和敏感点
- 性能方面：单服务器部署可能无法满足高并发需求。
- 可用性方面：单点故障可能导致服务中断。

### 6.2 再分析
- 系统原本采用三层C-S架构设计，即表示层、业务逻辑层和数据层，系统部署在一台应用服务器上，这种架构在面对非法访问入侵时，我们发现可能存在如下的问题：
- 在三层C/S架构中，一旦决定切断外网连接以应对攻击，重新建立连接可能需要较长时间，因为所有流量都通过单一路径管理。
- 三层C/S架构中，如果应用服务器或数据库服务器发生故障，整个系统可能变得不可用，且故障恢复需要花费较长时间。

### 6.3 改进系统的架构
- 引入边缘层来处理安全相关的任务，可以在网络边缘部署安全节点，用于初步过滤流量，减少恶意访问到达核心服务器的可能性。
- 采用多层分布式结构，使用Web服务器集群和应用服务器集群，支持动态负载平衡和容错机制，提高系统的稳定性和可用性。

## 7. 评审结论

通过对质量属性场景的分析，我们发现了架构方案的不足，并提出了改进措施。采用改进后的架构方案可以满足性能、安全性、易用性、可用性等关键质量属性需求，符合业务目标。
